{
"id": "drauven_cordAndVines_pc|RANGE_EXPRESSION|DAMAGE_EXPRESSION",
"info": {
	"dataVersion": 1,
	"sourceFile": "drauven/drauven_pc_cordAndVines",
	"author": "Patrick Belanger",
	"aiPriority": "2050"
},
"type": "ABILITY",
"verb": "ATTACK",
"ability": {
	"icon": "thornlash",
	"category": "attackAbility",
	"priority": "1",
	"onlyShowIfPossibleInCharacterSheet": true,
	"showDescriptionInTooltip": true,
	"cooldown": "oncePerTurn"
},
"targets": [
	{
		"template": "SELF",
		"cost": { "class": "ActionPoints", "actionPoints": "attack" },
		"missionFeedback": { "orientTo": "target" }
	},
	{
		"role": "source",
		"template": "ANY",
		"type": "SCENERY",
		"choose": "BY_SCORE",
		"scoreFunction": "((((plant+tree)+textile)+tools)+book)+wood",
		"scoreThreshold": "1",
		"missionFeedback": {
			"suggestionScript": "figures.abilitySelectOption",
			"hoverScript": "figures.abilitySelectHover",
			"selectedScript": "figures.abilitySelectSelected",
			"rangeFeedback": "FRIENDLY_EFFECT_RANGE",
			"suggestionFeedback": "FRIENDLY_EFFECT_SUGGESTION",
			"hoverFeedback": "FRIENDLY_EFFECT_HOVER"
		},
		"relationship": "interfusedWithEntity"
	},
	{
		"template": "ADJACENT_ENEMY",
		"showAnyway": true,
		"alwaysSelect": true,
		"aiHints": {
			"scoreNearbyFriend": "-10*isMatch(ACTIONS,2)",
			"friendRange": "1",
			"friendMaxRange": "4",
			"baseScore": "10000"
		},
		"aspects": [ "HOSTILE_TARGET", "alive" ],
		"relativeTo": "source",
		"range": "RANGE_EXPRESSION+self.BONUS_RANGE",
		"lineOfSight": "LIVE_FIGURES"
	},
	{
		"role": "targetTile",
		"template": "TILE",
		"showAnyway": true,
		"alwaysSelect": true,
		"missionFeedback": {
			"rangeFeedback": "FRIENDLY_EFFECT_RANGE",
			"suggestionFeedback": "FRIENDLY_EFFECT_SUGGESTION",
			"hoverFeedback": "FRIENDLY_EFFECT_HOVER",
			"applyRoleFootprint": "target",
			"showMovementFeedback": true
		},
		"aiHints": {
			"scoreNearbyFriend": "((((drauven_stump+(2*drauven_haunt))+(3*drauven_terrorbird))+(3*drauven_gorelord))+(3*drauven_pilotNobylle))*isMatch(ACTIONS,2)",
			"friendRange": "1",
			"friendMaxRange": "6"
		},
		"relativeTo": "target",
		"range": "3.1+self.BONUS_RANGE",
		"lineOfSight": "TERRAIN_ONLY",
		"tileFilter": "validMoveEnd",
		"roleMustFit": "target",
		"footprintWithinRange": "target",
		"footprintWithinRangeCompletely": true
	}
],
"outcomes": [
	{
		"class": "AttackRoll",
		"intermediateRole": "source",
		"attackAnimationType": "magic",
		"showAbilityName": "ifEnemy",
		"particles": [
			{ "script": "cordAndVines", "setPosition": "source", "setPosition2": "target" }
		],
		"audioOverride": { "attackHitCue": "Characters/Default/Ability_InterfusePlant" },
		"flankMarkOrigin": "source",
		"defenseRollTags": [ "range" ],
		"attackStrength": "self.RANGE_ACCURACY+10",
		"wield": "light",
		"always": { "class": "Damage", "target": "source", "amount": "1", "showInTooltip": false },
		"onHit": {
			"class": "DoAll",
			"outcomes": [
				{
					"class": "Test",
					"STUB": "If the target isn't immuneToKnockback, move them!",
					"value": "target.immuneToKnockback",
					"threshold": "1",
					"onFail": { "class": "MoveEntity", "directlyToTile": "targetTile" }
				},
				{ "class": "Damage", "amount": "DAMAGE_EXPRESSION+self.PHYSICAL_DAMAGE_BONUS" },
				{
					"class": "Aspects",
					"addAspects": [
						{ "id": "hobbled", "value": "1" }
					]
				}
			]
		},
		"onMiss": { "class": "DoAll" }
	}
]
}